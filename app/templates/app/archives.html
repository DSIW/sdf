{% extends 'base.html' %}

{% block body_classes %}archive{% endblock %}

{% block content %}
    <div class="container">
        <div id="newBook" class="{% if collapsed %}collapse{% endif %}" style="padding-top: 15px">
            <form role="form" method="post" action="">
                {% csrf_token %}
                {{ formset.management_form }}
                {% for form in formset %}
                    {% for field in form.visible_fields %}
                        <div class="input-field {% if field.errors %}has-error{% endif %}">
                            <label>{{ field.label }}</label>
                            {% if field.errors %} <span class="help-block" style="display: inline">(
                                {% for error in field.errors %}
                                    {{ error|escape }}
                                {% endfor %})</span>{% endif %}
                            {{ field }}
                        </div>
                    {% endfor %}
                {% endfor %}
                <button type="submit" class="btn waves-effect waves-light">Speichern</button>
            </form>
        </div>
    </div>

    <div class="container">
        <ul class="collection with-header" style="margin-top: 35px">
            <li class="collection-header">
                <h4>
                    Ihre Bücher
                    <a class="secondary-content btn-flat" data-toggle="collapse" data-target="#newBook">Buch anlegen</a>
                </h4>
            </li>
            {% for book in allSavedCustomerBooks %}
            <li class="collection-item">
                <div>
                    {{ book.name }}

                    <a class='secondary-content dropdown-button' href='javascript:void(0);' data-activates='book-{{ book.id }}-actions' data-constrainwidth="false">
                        <i class="material-icons">more_vert</i>
                    </a>
                    <ul id='book-{{ book.id }}-actions' class='dropdown-content'>
                        {% if not book.isOnStoreWindow %}
                        <li><a href="#">Veröffentlichen</a></li>
                        {% endif %}
                        {% if book.isOnStoreWindow %}
                        <li><a href="#">Nicht veröffentlichen</a></li>
                        {% endif %}
                        <li><a href="{% url 'archivesEditPage' book.id %}">Bearbeiten</a></li>
                        <li><a href="{% url 'deleteBook' book.id %}" data-method="delete" data-confirm="true" title="Löschen">Löschen</a></li>
                    </ul>
                </div>
            </li>
            {% endfor %}
        </ul>
    </div>
{% endblock %}
